--- src/add-ons/kernel/file_systems/bfs/BPlusTree.cpp	2025-07-18 11:05:37.309464176 +0000
+++ src/add-ons/kernel/file_systems/bfs/BPlusTree.cpp.original	2025-07-18 11:05:46.859015817 +0000
@@ -1436,6 +1436,9 @@
	if (*_keyIndex > node->NumKeys() + 1 || *_keyLength < 0)
		return B_BAD_VALUE;

+	if (uint32(node->AllKeyLength() + *_keyLength) > (uint32)fNodeSize)
+		return B_BAD_VALUE;
+
	Unaligned<uint16>* inKeyLengths = node->KeyLengths();
	Unaligned<off_t>* inKeyValues = node->Values();
	uint8* inKeys = node->Keys();
